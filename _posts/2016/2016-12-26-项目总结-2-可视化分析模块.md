---
layout: post
tittle: d3.js中力导向图节点与边的增加与删除  
categories:
- web
- project
- programming  
tags:
- d3.js
---

边与点的更新还有边标记的更新功能实现都是在update函数中实现的，下面贴下代码：  
1. 将nodes和links绑定到force  
```  
s.force.nodes(this.nodes)
            .force("link",d3.forceLink(this.links).distance(50).id(function(d) {  
                return d.id;  
            }))  
            .restart();  
```  
将nodes或links数组绑定到指定的dom元素上，这里以links举例  
```  
var link = this.vis.selectAll("line.link")  
            .data(this.links);  
```  
enter部分继续append相应dom元素，exit部分直接删除  
```  
linkEnter.append("line")  
               .attr("class","link")  
               .style("position","relative")  
               .style("z-index","-1");  
link.exit().remove();  
```  
最后一点，对于某些被绑定的dom的属性的设置，可以直接在设置里面在function中传递参数d将所绑定的数据传递进去，比如：  
```  
linktextEnter.append("text")  
               .style("font-size","12px")  
               .text(function(d){  
                   return getTag(d.source.type.toString()+d.target.type.toString());  
               })  
```    

**以上**就是update函数的核心部分，d3的灵魂就在与将dom元素与数据的绑定之上，可以用绑定的数据对元素进行各种设置和操作，重要的之后想起来再做补充。

